<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Making a linked map and time series plot â€¢ cubble</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Making a linked map and time series plot">
<meta property="og:description" content="cubble">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cubble</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/cubble.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/aggregation.html">Aggregating data spatially, and making glyph maps</a>
    </li>
    <li>
      <a href="../articles/cubble-design.html">Explanation of the cubble data structure</a>
    </li>
    <li>
      <a href="../articles/glyph.html">Making a glyph map</a>
    </li>
    <li>
      <a href="../articles/import.html">Importing spatiotemporal data into a cubble</a>
    </li>
    <li>
      <a href="../articles/interactive-plot.html">Making a linked map and time series plot</a>
    </li>
    <li>
      <a href="../articles/matching.html">Combining multiple data sources with simple spatiotemporal matching</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/huizezhang-sherry/cubble/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="interactive-plot_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Making a linked map and time series plot</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/huizezhang-sherry/cubble/blob/HEAD/vignettes/interactive-plot.Rmd" class="external-link"><code>vignettes/interactive-plot.Rmd</code></a></small>
      <div class="hidden name"><code>interactive-plot.Rmd</code></div>

    </div>

    
    
<p>Interactive graphics can be useful because they make it possible to look at the data in multiple of ways on-the-fly. This is especially important for spatio-temporal data, where we would like to interactively connect spatial and temporal displays. This vignette will show you how to make an interactive graphic with a cubble object. We will be using <code><a href="https://rdrr.io/pkg/crosstalk/man/bscols.html" class="external-link">crosstalk::bscols()</a></code> to create a linked interactive plot of an Australia map, made with leaflet, and a ggplot-turned plotly time series plot:</p>
<p><img src="cluster-diagram/interactive.png" width="712" style="display: block; margin: auto;"></p>
<p>This vignette assumes you have gone through <a href="cubble.html">Get started</a> and are familiar with basic data wrangling in cubble with <code><a href="../reference/face_temporal.html">face_temporal()</a></code> and <code><a href="../reference/face_spatial.html">face_spatial()</a></code>.</p>
<div class="section level2">
<h2 id="variation-of-the-diurnal-temperature-range-in-australia">Variation of the diurnal temperature range in Australia<a class="anchor" aria-label="anchor" href="#variation-of-the-diurnal-temperature-range-in-australia"></a>
</h2>
<p>Australia occupies a and different temperature patterns can be observed. Given the maximum and minimum temperature in the climate data in <code>climate_subset</code>, we can compute the average maximum and minimum temperature by month at each location. The difference between the maximum and minimum temperature, the diurnal temperature range, has different variations across the year and its variance will be used as the color for our plot. The codes below compute these variables:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">clean</span> <span class="op">&lt;-</span> <span class="va">climate_subset</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/face_temporal.html">face_temporal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>month <span class="op">=</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/month.html" class="external-link">month</a></span><span class="op">(</span><span class="va">date</span>, label <span class="op">=</span> <span class="cn">TRUE</span>, abbr <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">month</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    tmax <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">tmax</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    tmin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">tmin</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    diff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">tmax</span> <span class="op">-</span> <span class="va">tmin</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/face_spatial.html">face_spatial</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>temp_diff_var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">ts</span><span class="op">$</span><span class="va">diff</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># cubble:   id [30]: nested form</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># bbox:     [114.09, -41.88, 152.87, -11.65]</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># temporal: month [ord], tmax [dbl], tmin [dbl], diff [dbl]</span></span></span>
<span><span class="co">#&gt;    id            lat  long  elev name              wmo_id ts       temp_diff_var</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> ASN00003057 -<span style="color: #BB0000;">16.5</span>  123.   7   cygnet bay         <span style="text-decoration: underline;">94</span>201 &lt;tibble&gt;         8.27 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> ASN00005007 -<span style="color: #BB0000;">22.2</span>  114.   5   learmonth airport  <span style="text-decoration: underline;">94</span>302 &lt;tibble&gt;         1.80 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> ASN00005084 -<span style="color: #BB0000;">21.5</span>  115.   5   thevenard island   <span style="text-decoration: underline;">94</span>303 &lt;tibble&gt;         0.389</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> ASN00010515 -<span style="color: #BB0000;">32.1</span>  117. 199   beverley           <span style="text-decoration: underline;">95</span>615 &lt;tibble&gt;         5.08 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> ASN00012314 -<span style="color: #BB0000;">27.8</span>  121. 497   leinster aero      <span style="text-decoration: underline;">95</span>448 &lt;tibble&gt;         0.868</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> ASN00014401 -<span style="color: #BB0000;">11.7</span>  133.  19.2 warruwi            <span style="text-decoration: underline;">94</span>139 &lt;tibble&gt;         0.662</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> ASN00014703 -<span style="color: #BB0000;">15.7</span>  137.  12.2 centre island      <span style="text-decoration: underline;">94</span>248 &lt;tibble&gt;         0.314</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> ASN00017123 -<span style="color: #BB0000;">28.1</span>  140.  37.8 moomba airport     <span style="text-decoration: underline;">95</span>481 &lt;tibble&gt;         1.36 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> ASN00018201 -<span style="color: #BB0000;">32.5</span>  138.  14   port augusta aero  <span style="text-decoration: underline;">95</span>666 &lt;tibble&gt;         2.56 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> ASN00022841 -<span style="color: #BB0000;">35.7</span>  138.   5   kingscote aero     <span style="text-decoration: underline;">95</span>807 &lt;tibble&gt;         3.72 </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â€¦ with 20 more rows</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="linking-with-crosstalk">Linking with crosstalk<a class="anchor" aria-label="anchor" href="#linking-with-crosstalk"></a>
</h2>
<p>Crosstalk accepts linking between multiple data objects in the same group. Here we create two SharedData objects (one using the nested form and another using the long form), with <code>id</code> as the key and give them the same group name (<code>group = "cubble"</code>):</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nested</span> <span class="op">&lt;-</span> <span class="va">clean</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="va">SharedData</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">~</span><span class="va">id</span>, group <span class="op">=</span> <span class="st">"cubble"</span><span class="op">)</span></span>
<span><span class="va">long</span> <span class="op">&lt;-</span> <span class="va">clean</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/face_temporal.html">face_temporal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/cubble-verb.html">unfold</a></span><span class="op">(</span><span class="va">temp_diff_var</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">temp_diff_var</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="va">SharedData</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">~</span><span class="va">id</span>, group <span class="op">=</span> <span class="st">"cubble"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="create-maps-with-leaflet">Create maps with leaflet<a class="anchor" aria-label="anchor" href="#create-maps-with-leaflet"></a>
</h2>
<p>A basic leaflet map of stations can be created with an underlying map tile (<code>addTiles()</code>) and points to represent stations (<code>addCircleMarkers()</code>):</p>
<pre><code><span><span class="fu">leaflet</span><span class="op">(</span><span class="va">nested</span>, width <span class="op">=</span> <span class="fl">300</span>, height <span class="op">=</span> <span class="fl">300</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">addTiles</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">addCircleMarkers</span><span class="op">(</span><span class="op">)</span></span></code></pre>
<p>Applying color to the stations requires mapping the variable in the data to the color palette. Here the numerical variable <code>temp_diff_var</code> is mapped onto a sequential color palette, Rocket, with some fine-tuning using <code>colorNumeric()</code>. A popup of station names can be added with the <code>popup</code> argument in <code>addCircleMarkers()</code> and a <code>~</code> is needed when specifying variable name in leaflet syntax:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">domain</span> <span class="op">&lt;-</span> <span class="va">clean</span><span class="op">$</span><span class="va">temp_diff_var</span></span>
<span><span class="va">pal</span> <span class="op">&lt;-</span> <span class="fu">colorNumeric</span><span class="op">(</span></span>
<span>  <span class="fu">colorspace</span><span class="fu">::</span><span class="fu"><a href="https://colorspace.R-Forge.R-project.org/reference/hcl_palettes.html" class="external-link">sequential_hcl</a></span><span class="op">(</span></span>
<span>    <span class="st">"Rocket"</span>,  n <span class="op">=</span> <span class="fl">7</span>, cmax <span class="op">=</span> <span class="fl">90</span>, rev <span class="op">=</span> <span class="cn">TRUE</span>, c2 <span class="op">=</span> <span class="fl">40</span>, l2<span class="op">=</span> <span class="fl">85</span>, c1 <span class="op">=</span> <span class="fl">20</span>, l1 <span class="op">=</span> <span class="fl">30</span><span class="op">)</span>,</span>
<span>  domain <span class="op">=</span> <span class="va">domain</span><span class="op">)</span></span>
<span></span>
<span><span class="va">map</span> <span class="op">&lt;-</span> <span class="fu">leaflet</span><span class="op">(</span><span class="va">nested</span>, width <span class="op">=</span> <span class="fl">300</span>, height <span class="op">=</span> <span class="fl">300</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">addTiles</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">addCircleMarkers</span><span class="op">(</span>color <span class="op">=</span> <span class="op">~</span><span class="fu">pal</span><span class="op">(</span><span class="va">domain</span><span class="op">)</span>, group <span class="op">=</span> <span class="st">"a"</span>, radius <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>                   popup <span class="op">=</span> <span class="op">~</span><span class="va">name</span>, fillOpacity <span class="op">=</span> <span class="fl">1</span>, opacity <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="time-series-plot-with-plotly">Time series plot with plotly<a class="anchor" aria-label="anchor" href="#time-series-plot-with-plotly"></a>
</h2>
<p>The time series plot can show the temperature band of each station, allowing for visualising the diurnal temperature range by month. We use <code><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon()</a></code> to create a temperature band that shows both the maximum and minimum temperature and add <code>geom_points()</code> to allow selection on the plot:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ts_static</span> <span class="op">&lt;-</span> <span class="va">long</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">month</span>, group <span class="op">=</span> <span class="va">id</span>,</span>
<span>         fill <span class="op">=</span> <span class="va">temp_diff_var</span>, color <span class="op">=</span> <span class="va">temp_diff_var</span></span>
<span>         <span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">tmin</span>, ymax <span class="op">=</span> <span class="va">tmax</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">0.1</span>, alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># geom_point(aes(y = tmax), size = 0.1) +</span></span>
<span>  <span class="co"># geom_point(aes(y = tmin), size = 0.1) +</span></span>
<span>  <span class="fu">colorspace</span><span class="fu">::</span><span class="fu"><a href="https://colorspace.R-Forge.R-project.org/reference/scale_colour_continuous_sequential.html" class="external-link">scale_fill_continuous_sequential</a></span><span class="op">(</span></span>
<span>    <span class="st">"Rocket"</span>,  n_interp <span class="op">=</span> <span class="fl">7</span>, cmax <span class="op">=</span> <span class="fl">90</span>, rev <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    c2 <span class="op">=</span> <span class="fl">40</span>, l2<span class="op">=</span> <span class="fl">85</span>, c1 <span class="op">=</span> <span class="fl">20</span>, l1 <span class="op">=</span> <span class="fl">30</span>, name <span class="op">=</span> <span class="st">"Var. temp. diff."</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">colorspace</span><span class="fu">::</span><span class="fu"><a href="https://colorspace.R-Forge.R-project.org/reference/scale_colour_continuous_sequential.html" class="external-link">scale_colour_continuous_sequential</a></span><span class="op">(</span></span>
<span>    <span class="st">"Rocket"</span>,  n_interp <span class="op">=</span> <span class="fl">7</span>, cmax <span class="op">=</span> <span class="fl">90</span>, rev <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    c2 <span class="op">=</span> <span class="fl">40</span>, l2<span class="op">=</span> <span class="fl">85</span>, c1 <span class="op">=</span> <span class="fl">20</span>, l1 <span class="op">=</span> <span class="fl">30</span>, name <span class="op">=</span> <span class="st">"Var. temp. diff."</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Month"</span>, y <span class="op">=</span> <span class="st">"Temperature"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    panel.grid.major <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"bottom"</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<p>The static ggplot object can be turned into a plotly object with <code>ggplotly()</code> and <code><a href="https://rdrr.io/pkg/plotly/man/highlight.html" class="external-link">plotly::highlight()</a></code> enable the selection with box or lasso (<code>on = "plotly_selected"</code>):</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ts_interactive</span> <span class="op">&lt;-</span> <span class="fu">ggplotly</span><span class="op">(</span><span class="va">ts_static</span>, width <span class="op">=</span> <span class="fl">600</span>, height <span class="op">=</span> <span class="fl">300</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">highlight</span><span class="op">(</span>on <span class="op">=</span> <span class="st">"plotly_selected"</span>, opacityDim <span class="op">=</span> <span class="fl">0.012</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="assemble-into-a-linked-plot">Assemble into a linked plot<a class="anchor" aria-label="anchor" href="#assemble-into-a-linked-plot"></a>
</h2>
<p><code><a href="https://rdrr.io/pkg/crosstalk/man/bscols.html" class="external-link">crosstalk::bscols()</a></code> can be thought of as the <code>patchwork</code> for interactive graphics, which arranges multiple interactive graphics in columns.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">bscols</span><span class="op">(</span><span class="va">map</span>, <span class="va">ts_interactive</span>, widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Below is a screenshot of the full graphics:</p>
<p><img src="cluster-diagram/interactive-full.png" width="150%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="making-selection-to-see-the-linking">Making selection to see the linking<a class="anchor" aria-label="anchor" href="#making-selection-to-see-the-linking"></a>
</h2>
<p>The selection built in the linked plot goes in both directions. In the screenshot below, a lasso selection is made on the time series and this links to cygnet bay on the northwest coastline of Australia. The area has a larger temperature range in July than in the summer period (December - February).</p>
<p><img src="cluster-diagram/selection1.png" width="150%" style="display: block; margin: auto;"></p>
<p>Selection on the leaflet map is made through the selection tool below the zoom-in/out bottom on the map. Two selections are made on northern Australia and inland Queensland. Northern Australia has a narrow temperature range constantly 20 degrees throughout the year, while the temperature range in inland Queensland is much larger and there is a clear difference between the summer and winter periods.</p>
<p><img src="cluster-diagram/selection2.png" width="150%" style="display: block; margin: auto;"></p>
<p><img src="cluster-diagram/selection3.png" width="150%" style="display: block; margin: auto;"></p>
<p>Now it is your time to view the tooltip on the map and use the selection to explore weather patterns in Australia!</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by H. Sherry Zhang, Dianne Cook, Ursula Laa, Nicolas LangrenÃ©, Patricia MenÃ©ndez.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
