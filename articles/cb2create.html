<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>2. Creation and coercion • cubble</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="2. Creation and coercion">
<meta property="og:description" content="cubble">
<meta property="og:image" content="/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cubble</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/cb1class.html">1. The cubble class</a>
    </li>
    <li>
      <a href="../articles/cb2create.html">2. Creation and coercion</a>
    </li>
    <li>
      <a href="../articles/cb3tsibblesf.html">3. Compatibility with tsibble and sf</a>
    </li>
    <li>
      <a href="../articles/cb4glyph.html">4. Making a glyph map</a>
    </li>
    <li>
      <a href="../articles/cb5match.html">5. Matching different data sources</a>
    </li>
    <li>
      <a href="../articles/cb6interactive.html">6. Interactive graphics</a>
    </li>
    <li>
      <a href="../articles/cb7misc.html">7. Miscellaneous</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/huizezhang-sherry/cubble/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>2. Creation and coercion</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/huizezhang-sherry/cubble/blob/HEAD/vignettes/cb2create.Rmd" class="external-link"><code>vignettes/cb2create.Rmd</code></a></small>
      <div class="hidden name"><code>cb2create.Rmd</code></div>

    </div>

    
    
<p>This article demonstrates how to create a cubble from various types
of data. We will create a cubble from:</p>
<ul>
<li>separate spatial and temporal tables</li>
<li>a <code>tibble</code> object</li>
<li>NetCDF data</li>
<li>an <code>stars</code> object</li>
<li>an <code>sftime</code> object</li>
</ul>
<div class="section level2">
<h2 id="create-from-separate-spatial-and-temporal-tables">Create from separate spatial and temporal tables<a class="anchor" aria-label="anchor" href="#create-from-separate-spatial-and-temporal-tables"></a>
</h2>
<p>In many cases, spatio-temporal data arrive in separate tables for
analysis. For example, in climate data, analysts may initially receive
station data containing geographic location information, recorded
variables and their recording periods. They can then query the temporal
variables using the stations of interest to obtain the relevant temporal
data. Alternatively, analyses may begin as purely spatial or temporal,
and analysts may obtain additional temporal or spatial data to expand
the result to spatio-temporal.</p>
<p>The function <code><a href="../reference/cubble-class.html">make_cubble()</a></code> composes a cubble object from
a spatial table (<code>spatial</code>) and a temporal table
(<code>temporal</code>), along with the three attributes
<code>key</code>, <code>index</code>, and <code>coords</code> introduced
in <a href="cb1class.html">1. The cubble class</a>. The following code
creates the nested <code>cubble</code>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/cubble-class.html">make_cubble</a></span><span class="op">(</span>spatial <span class="op">=</span> <span class="va">stations</span>, temporal <span class="op">=</span> <span class="va">meteo</span>,</span>
<span>            key <span class="op">=</span> <span class="va">id</span>, index <span class="op">=</span> <span class="va">date</span>, coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">long</span>, <span class="va">lat</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># cubble:   key: id [3], index: date, nested form</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># spatial:  [144.8321, -37.98, 145.0964, -37.6655], Missing CRS!</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># temporal: date [date], prcp [dbl], tmax [dbl], tmin [dbl]</span></span></span>
<span><span class="co">#&gt;   id           long   lat  elev name              wmo_id ts               </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> ASN00086038  145. -<span style="color: #BB0000;">37.7</span>  78.4 essendon airport   <span style="text-decoration: underline;">95</span>866 <span style="color: #949494;">&lt;tibble [10 × 4]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> ASN00086077  145. -<span style="color: #BB0000;">38.0</span>  12.1 moorabbin airport  <span style="text-decoration: underline;">94</span>870 <span style="color: #949494;">&lt;tibble [10 × 4]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> ASN00086282  145. -<span style="color: #BB0000;">37.7</span> 113.  melbourne airport  <span style="text-decoration: underline;">94</span>866 <span style="color: #949494;">&lt;tibble [10 × 4]&gt;</span></span></span></code></pre></div>
<p>The <code>coords</code> argument can be safely omitted if the spatial
data is an sf object (e.g. <code>stations_sf</code>) . Similarly, if the
temporal object is a tsibble (i.e. <code>meteo_ts</code>), you don’t
need to specify the <code>key</code> and <code>index</code> arguments.
The class attributes from sf and tsibble will be carried over to the
nested and long cubble:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cubble-class.html">make_cubble</a></span><span class="op">(</span>spatial <span class="op">=</span> <span class="va">stations_sf</span>, temporal <span class="op">=</span> <span class="va">meteo_ts</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># cubble:   key: id [3], index: date, nested form, [sf]</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># spatial:  [144.8321, -37.98, 145.0964, -37.6655], WGS 84</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># temporal: date [date], prcp [dbl], tmax [dbl], tmin [dbl]</span></span></span>
<span><span class="co">#&gt;   id           elev name   wmo_id  long   lat            geometry ts      </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;POINT [°]&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> ASN00086038  78.4 essen…  <span style="text-decoration: underline;">95</span>866  145. -<span style="color: #BB0000;">37.7</span> (144.9066 -37.7276) <span style="color: #949494;">&lt;tbl_ts&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> ASN00086077  12.1 moora…  <span style="text-decoration: underline;">94</span>870  145. -<span style="color: #BB0000;">38.0</span>   (145.0964 -37.98) <span style="color: #949494;">&lt;tbl_ts&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> ASN00086282 113.  melbo…  <span style="text-decoration: underline;">94</span>866  145. -<span style="color: #BB0000;">37.7</span> (144.8321 -37.6655) <span style="color: #949494;">&lt;tbl_ts&gt;</span></span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "spatial_cubble_df" "cubble_df"         "sf"               </span></span>
<span><span class="co">#&gt; [4] "tbl_df"            "tbl"               "data.frame"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">ts</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "tbl_ts"     "tbl_df"     "tbl"        "data.frame"</span></span></code></pre></div>
<p>The vignette <a href="cb3tsibblesf.html">3. Compatibility with
tsibble and sf</a> will introduce more on the cubble’s compatibility
with tsibble and sf.</p>
</div>
<div class="section level2">
<h2 id="coerce-from-foreign-objects">Coerce from foreign objects<a class="anchor" aria-label="anchor" href="#coerce-from-foreign-objects"></a>
</h2>
<div class="section level3">
<h3 id="the-tibble-objects">The <code>tibble</code> objects<a class="anchor" aria-label="anchor" href="#the-tibble-objects"></a>
</h3>
<p>The dataset <code>climate_flat</code> combines the spatial data,
<code>stations</code>, with the temporal data, <code>meteo</code>, into
a single tibble object. It can be coerced into a cubble using:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">climate_flat</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/as_cubble.html">as_cubble</a></span><span class="op">(</span>key <span class="op">=</span> <span class="va">id</span>, index <span class="op">=</span> <span class="va">date</span>, coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">long</span>, <span class="va">lat</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># cubble:   key: id [3], index: date, nested form</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># spatial:  [144.8321, -37.98, 145.0964, -37.6655], Missing CRS!</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># temporal: date [date], prcp [dbl], tmax [dbl], tmin [dbl]</span></span></span>
<span><span class="co">#&gt;   id           long   lat  elev name              wmo_id ts               </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> ASN00086038  145. -<span style="color: #BB0000;">37.7</span>  78.4 essendon airport   <span style="text-decoration: underline;">95</span>866 <span style="color: #949494;">&lt;tibble [10 × 4]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> ASN00086077  145. -<span style="color: #BB0000;">38.0</span>  12.1 moorabbin airport  <span style="text-decoration: underline;">94</span>870 <span style="color: #949494;">&lt;tibble [10 × 4]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> ASN00086282  145. -<span style="color: #BB0000;">37.7</span> 113.  melbourne airport  <span style="text-decoration: underline;">94</span>866 <span style="color: #949494;">&lt;tibble [10 × 4]&gt;</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="the-netcdf-data">The NetCDF data<a class="anchor" aria-label="anchor" href="#the-netcdf-data"></a>
</h3>
<p>In <code>R</code>, there are several packages available for wrangling
NetCDF data, including <code>ncdf4</code>, <code>RNetCDF</code>, and
<code>tidync</code>. The code below converts a NetCDF object of class
ncdf4 into a cubble object:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"ncdf/era5-pressure.nc"</span>, package <span class="op">=</span> <span class="st">"cubble"</span><span class="op">)</span></span>
<span><span class="va">raw</span> <span class="op">&lt;-</span> <span class="fu">ncdf4</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ncdf4/man/nc_open.html" class="external-link">nc_open</a></span><span class="op">(</span><span class="va">path</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/as_cubble.html">as_cubble</a></span><span class="op">(</span><span class="va">raw</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># cubble:   key: id [26565], index: time, nested form</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># spatial:  [113, -53, 153, -12], Missing CRS!</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># temporal: time [date], q [dbl], z [dbl]</span></span></span>
<span><span class="co">#&gt;       id  long   lat ts              </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1  113    -<span style="color: #BB0000;">12</span> <span style="color: #949494;">&lt;tibble [6 × 3]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     2  113.   -<span style="color: #BB0000;">12</span> <span style="color: #949494;">&lt;tibble [6 × 3]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     3  114.   -<span style="color: #BB0000;">12</span> <span style="color: #949494;">&lt;tibble [6 × 3]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     4  114.   -<span style="color: #BB0000;">12</span> <span style="color: #949494;">&lt;tibble [6 × 3]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     5  114    -<span style="color: #BB0000;">12</span> <span style="color: #949494;">&lt;tibble [6 × 3]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     6  114.   -<span style="color: #BB0000;">12</span> <span style="color: #949494;">&lt;tibble [6 × 3]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     7  114.   -<span style="color: #BB0000;">12</span> <span style="color: #949494;">&lt;tibble [6 × 3]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     8  115.   -<span style="color: #BB0000;">12</span> <span style="color: #949494;">&lt;tibble [6 × 3]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     9  115    -<span style="color: #BB0000;">12</span> <span style="color: #949494;">&lt;tibble [6 × 3]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>    10  115.   -<span style="color: #BB0000;">12</span> <span style="color: #949494;">&lt;tibble [6 × 3]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 26,555 more rows</span></span></span></code></pre></div>
<p>Sometimes, analysts may choose to read only a subset of the NetCDF
data. In such cases, the <code>vars</code>, <code>long_range</code> and
<code>lat_range</code> arguments can be used to subset the data based on
the variable and the grid resolution:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/as_cubble.html">as_cubble</a></span><span class="op">(</span><span class="va">raw</span>, vars <span class="op">=</span> <span class="st">"q"</span>,</span>
<span>          long_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">180</span>, <span class="fl">180</span>, <span class="fl">1</span><span class="op">)</span>, lat_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">90</span>, <span class="fl">90</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="the-stars-objects">The <code>stars</code> objects<a class="anchor" aria-label="anchor" href="#the-stars-objects"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tif</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"tif/L7_ETMs.tif"</span>, package <span class="op">=</span> <span class="st">"stars"</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">stars</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/stars/reference/read_stars.html" class="external-link">read_stars</a></span><span class="op">(</span><span class="va">tif</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/as_cubble.html">as_cubble</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># cubble:   key: id [122848], index: time, nested form</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># spatial:  [288790.500000803, 9110743.00002899, 298708.50000055,</span></span></span>
<span><span class="co"><span style="color: #949494;">#&gt; #   9120746.50002874], Missing CRS!</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># temporal: band [int], L7_ETMs.tif [dbl]</span></span></span>
<span><span class="co">#&gt;          x        y     id ts              </span></span>
<span><span class="co">#&gt;      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> <span style="text-decoration: underline;">288</span>791. 9<span style="text-decoration: underline;">120</span>747. <span style="text-decoration: underline;">122</span>500 <span style="color: #949494;">&lt;tibble [6 × 2]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> <span style="text-decoration: underline;">288</span>819. 9<span style="text-decoration: underline;">120</span>747. <span style="text-decoration: underline;">122</span>501 <span style="color: #949494;">&lt;tibble [6 × 2]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> <span style="text-decoration: underline;">288</span>848. 9<span style="text-decoration: underline;">120</span>747. <span style="text-decoration: underline;">122</span>502 <span style="color: #949494;">&lt;tibble [6 × 2]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> <span style="text-decoration: underline;">288</span>876. 9<span style="text-decoration: underline;">120</span>747. <span style="text-decoration: underline;">122</span>503 <span style="color: #949494;">&lt;tibble [6 × 2]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> <span style="text-decoration: underline;">288</span>905. 9<span style="text-decoration: underline;">120</span>747. <span style="text-decoration: underline;">122</span>504 <span style="color: #949494;">&lt;tibble [6 × 2]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> <span style="text-decoration: underline;">288</span>933. 9<span style="text-decoration: underline;">120</span>747. <span style="text-decoration: underline;">122</span>505 <span style="color: #949494;">&lt;tibble [6 × 2]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> <span style="text-decoration: underline;">288</span>962. 9<span style="text-decoration: underline;">120</span>747. <span style="text-decoration: underline;">122</span>506 <span style="color: #949494;">&lt;tibble [6 × 2]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> <span style="text-decoration: underline;">288</span>990. 9<span style="text-decoration: underline;">120</span>747. <span style="text-decoration: underline;">122</span>507 <span style="color: #949494;">&lt;tibble [6 × 2]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> <span style="text-decoration: underline;">289</span>019. 9<span style="text-decoration: underline;">120</span>747. <span style="text-decoration: underline;">122</span>508 <span style="color: #949494;">&lt;tibble [6 × 2]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> <span style="text-decoration: underline;">289</span>047. 9<span style="text-decoration: underline;">120</span>747. <span style="text-decoration: underline;">122</span>509 <span style="color: #949494;">&lt;tibble [6 × 2]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 122,838 more rows</span></span></span></code></pre></div>
<p>When the <code>dimensions</code> object is too complex for the
<code>cubble</code> package to handle, a warning message will be
generated.</p>
</div>
<div class="section level3">
<h3 id="the-sftime-objects">The <code>sftime</code> objects<a class="anchor" aria-label="anchor" href="#the-sftime-objects"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dt</span> <span class="op">&lt;-</span> <span class="va">climate_flat</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span>coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"long"</span>, <span class="st">"lat"</span><span class="op">)</span>, crs <span class="op">=</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs</a></span><span class="op">(</span><span class="st">"OGC:CRS84"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">sftime</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sftime/man/st_as_sftime.html" class="external-link">st_as_sftime</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">dt</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/as_cubble.html">as_cubble</a></span><span class="op">(</span>key <span class="op">=</span> <span class="va">id</span>, index <span class="op">=</span> <span class="va">date</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># cubble:   key: id [3], index: date, nested form, [sf]</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># spatial:  [144.8321, -37.98, 145.0964, -37.6655], WGS 84</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># temporal: prcp [dbl], tmax [dbl], tmin [dbl], date [date]</span></span></span>
<span><span class="co">#&gt;   id           elev name   wmo_id            geometry  long   lat ts      </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;POINT [°]&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> ASN00086038  78.4 essen…  <span style="text-decoration: underline;">95</span>866 (144.9066 -37.7276)  145. -<span style="color: #BB0000;">37.7</span> <span style="color: #949494;">&lt;tibble&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> ASN00086077  12.1 moora…  <span style="text-decoration: underline;">94</span>870   (145.0964 -37.98)  145. -<span style="color: #BB0000;">38.0</span> <span style="color: #949494;">&lt;tibble&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> ASN00086282 113.  melbo…  <span style="text-decoration: underline;">94</span>866 (144.8321 -37.6655)  145. -<span style="color: #BB0000;">37.7</span> <span style="color: #949494;">&lt;tibble&gt;</span></span></span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by H. Sherry Zhang, Dianne Cook, Ursula Laa, Nicolas Langrené, Patricia Menéndez.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
