<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Getting started with cubble • cubble</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Getting started with cubble">
<meta property="og:description" content="cubble">
<meta property="og:image" content="/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cubble</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/cubble.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/cb1class.html">1. The cubble class</a>
    </li>
    <li>
      <a href="../articles/cb2create.html">2. Creation and coercion</a>
    </li>
    <li>
      <a href="../articles/cb3glyph.html">3. Making a glyph map</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/huizezhang-sherry/cubble/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Getting started with cubble</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/huizezhang-sherry/cubble/blob/HEAD/vignettes/cubble.Rmd" class="external-link"><code>vignettes/cubble.Rmd</code></a></small>
      <div class="hidden name"><code>cubble.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/huizezhang-sherry/cubble" class="external-link">cubble</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<p>Global Historical Climatology Network (GHCN) provides daily climate
measures from stations across the world. The dataset
<code>climate_aus</code> extracts the maximum temperature for 639
Australian stations in the period 1970 - 1975 and 2016 - 2020 from the
full Australian historical records starting from year 1969.
<code>climate_aus</code> is already in a cubble, with <code>id</code> as
the key, <code>date</code> as the index, and <code>c(long, lat)</code>
as the coordinates. This vignette shows the basic manipulation of cubble
in an example to compares the maximum temperature in these two periods
for weather stations in Victoria, Australia.</p>
<div class="section level2">
<h2 id="spatial-manipulation">Spatial manipulation<a class="anchor" aria-label="anchor" href="#spatial-manipulation"></a>
</h2>
<p>Victoria stations can be subset by the station number: Australia GHCN
station number starts with “ASN00” and followed by the <a href="http://www.bom.gov.au/climate/cdo/about/site-num.shtml" class="external-link">Bureau of
Meteorology (BOM) station number</a>, where the 2nd and 3rd digit (7th
and 8th in the GHCN number) define the state of the station. Victoria
stations start from 76 to 90 and filtering Victoria stations is an
operation in the spatial dimension. Hence we want to use the nested
form:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tmax</span> <span class="op">&lt;-</span> <span class="va">climate_aus</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/between.html" class="external-link">between</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_sub.html" class="external-link">str_sub</a></span><span class="op">(</span><span class="va">id</span>, <span class="fl">7</span>, <span class="fl">8</span><span class="op">)</span><span class="op">)</span>, <span class="fl">76</span>, <span class="fl">90</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tmax</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># cubble:   key: id [79], index: date, nested form</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># spatial:  [141.2657, -39.1297, 149.9158, -34.2358], Missing CRS!</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># temporal: date [date], prcp [dbl], tmax [dbl], tmin [dbl]</span></span></span>
<span><span class="co">#&gt;    id           long   lat  elev name                wmo_id ts                </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> ASN00076031  142. -<span style="color: #BB0000;">34.2</span>  50   mildura airport      <span style="text-decoration: underline;">94</span>693 <span style="color: #949494;">&lt;tibble [366 × 4]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> ASN00076047  142. -<span style="color: #BB0000;">35.1</span>  50.3 ouyen (post office)  <span style="text-decoration: underline;">94</span>831 <span style="color: #949494;">&lt;tibble [366 × 4]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> ASN00076064  142. -<span style="color: #BB0000;">35.1</span> 105   walpeup research     <span style="text-decoration: underline;">95</span>831 <span style="color: #949494;">&lt;tibble [366 × 4]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> ASN00077010  142. -<span style="color: #BB0000;">35.7</span>  77.3 hopetoun airport     <span style="text-decoration: underline;">94</span>838 <span style="color: #949494;">&lt;tibble [366 × 4]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> ASN00077094  144. -<span style="color: #BB0000;">35.4</span>  71   swan hill aerodrome  <span style="text-decoration: underline;">94</span>843 <span style="color: #949494;">&lt;tibble [366 × 4]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> ASN00078015  142. -<span style="color: #BB0000;">36.3</span> 139.  nhill aerodrome      <span style="text-decoration: underline;">94</span>827 <span style="color: #949494;">&lt;tibble [366 × 4]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> ASN00079028  142. -<span style="color: #BB0000;">36.7</span> 133   longerenong          <span style="text-decoration: underline;">95</span>835 <span style="color: #949494;">&lt;tibble [366 × 4]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> ASN00079097  142. -<span style="color: #BB0000;">37.1</span> 189.  kanagulk             <span style="text-decoration: underline;">95</span>827 <span style="color: #949494;">&lt;tibble [366 × 4]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> ASN00079099  141. -<span style="color: #BB0000;">37.0</span> 155   edenhope airport     <span style="text-decoration: underline;">95</span>832 <span style="color: #949494;">&lt;tibble [366 × 4]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> ASN00079100  142. -<span style="color: #BB0000;">36.7</span> 134.  horsham aerodrome    <span style="text-decoration: underline;">95</span>839 <span style="color: #949494;">&lt;tibble [366 × 4]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 69 more rows</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="temporal-manipulation">Temporal manipulation<a class="anchor" aria-label="anchor" href="#temporal-manipulation"></a>
</h2>
<p><code><a href="../reference/face.html">face_temporal()</a></code> switches a spatial (nested) cubble into
a temporal (long) one for temporal operations: The long form cubble is
for operations whose output is cross-identified by <code>key</code> and
<code>index</code>.</p>
<p>We would also like to summarise the daily recording into monthly to
smooth the maximum temperature and since it is also a time dimension
operation, we can keep using the long form:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tmax</span> <span class="op">&lt;-</span> <span class="va">tmax</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/face.html">face_temporal</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span>month <span class="op">=</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/month.html" class="external-link">month</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>tmax <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">tmax</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tmax</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># cubble:   key: id [79], index: month, long form, groups: month [12]</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># temporal: 1 -- 12 [1], has gaps!</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># spatial:  long [dbl], lat [dbl], elev [dbl], name [chr], wmo_id [dbl]</span></span></span>
<span><span class="co">#&gt;    month id           tmax</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1 ASN00076031  33.2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     1 ASN00076047  33.1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     1 ASN00076064  32.7</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     1 ASN00077010  32.3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     1 ASN00077094  33.2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     1 ASN00078015  30.6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     1 ASN00079028  31.1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     1 ASN00079097  28.8</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     1 ASN00079099  28.6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>     1 ASN00079100  30.6</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 926 more rows</span></span></span></code></pre></div>
<!-- `face_spatial()` switches a temporal (long) cubble back to the spatial (nested) one for spatial operations and operations summarising temporal information as per location, for example, calculating the average maximum temperature: -->
</div>
<div class="section level2">
<h2 id="the-final-step">The final step<a class="anchor" aria-label="anchor" href="#the-final-step"></a>
</h2>
<p>In the glyph map we are about to create, the four variables (major
and minor axis for x and y) need to be in the same table. In cubble, you
can move time invariant variable into the long form with
<code><a href="../reference/unfold.html">unfold()</a></code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tmax</span> <span class="op">&lt;-</span> <span class="va">tmax</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>  <span class="fu"><a href="../reference/unfold.html">unfold</a></span><span class="op">(</span><span class="va">long</span>, <span class="va">lat</span><span class="op">)</span></span>
<span><span class="va">tmax</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># cubble:   key: id [79], index: month, long form</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># temporal: 1 -- 12 [1], has gaps!</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># spatial:  long [dbl], lat [dbl], elev [dbl], name [chr], wmo_id [dbl]</span></span></span>
<span><span class="co">#&gt;    month id           tmax  long   lat</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1 ASN00076031  33.2  142. -<span style="color: #BB0000;">34.2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     1 ASN00076047  33.1  142. -<span style="color: #BB0000;">35.1</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     1 ASN00076064  32.7  142. -<span style="color: #BB0000;">35.1</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     1 ASN00077010  32.3  142. -<span style="color: #BB0000;">35.7</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     1 ASN00077094  33.2  144. -<span style="color: #BB0000;">35.4</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     1 ASN00078015  30.6  142. -<span style="color: #BB0000;">36.3</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     1 ASN00079028  31.1  142. -<span style="color: #BB0000;">36.7</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     1 ASN00079097  28.8  142. -<span style="color: #BB0000;">37.1</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     1 ASN00079099  28.6  141. -<span style="color: #BB0000;">37.0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>     1 ASN00079100  30.6  142. -<span style="color: #BB0000;">36.7</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 926 more rows</span></span></span></code></pre></div>
<p>Now you have seen the basic wrangling with cubble, it is time to make
some plots! The vignette <a href="glyph.html">Making glyph map</a> will
show you how to plot time series in the space using a glyph map.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by H. Sherry Zhang, Dianne Cook, Ursula Laa, Nicolas Langrené, Patricia Menéndez.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
